# 写旅记功能文档

## 功能概述

智能旅行应用的写旅记功能，提供了一个完整的旅行分享编辑器，支持富文本编辑、图片上传、位置标记、标签管理等功能。

## 主要特性

### 1. 文本编辑
- **标题输入**: 支持最多50字符的标题，实时显示字数统计
- **内容编辑**: 大容量富文本编辑器，支持最多5000字符
- **字数统计**: 实时显示当前字数和字数限制
- **占位符提示**: 根据选择的分类动态显示编辑提示

### 2. 分类管理
- **四大分类**: 衣、食、住、行四个主要旅行分类
- **图标展示**: 每个分类都有对应的emoji图标
- **动态提示**: 根据分类调整编辑器的占位符文本

### 3. 图片管理
- **多图上传**: 支持最多9张图片上传
- **格式支持**: 支持JPG、PNG、GIF等常见图片格式
- **大小限制**: 单张图片不超过10MB
- **智能压缩**: 自动压缩大尺寸图片以优化性能
- **拖拽排序**: 支持长按拖拽调整图片顺序
- **预览删除**: 支持图片预览和单张删除

### 4. 位置服务
- **当前定位**: 自动获取用户当前位置
- **搜索功能**: 支持按城市、景点、地址搜索
- **最近使用**: 记录最近使用的8个位置
- **热门推荐**: 提供热门城市和景点推荐
- **位置类型**: 区分城市、景点、公园等不同类型

### 5. 标签系统
- **热门标签**: 提供旅行相关的推荐标签
- **自定义标签**: 支持用户自定义添加标签
- **标签限制**: 最多添加10个标签
- **智能提示**: 根据已添加标签过滤推荐列表

### 6. 草稿功能
- **自动保存**: 每30秒自动保存草稿到本地
- **手动保存**: 支持手动保存草稿
- **草稿恢复**: 应用重新打开时提示恢复草稿
- **草稿过期**: 7天后自动清理过期草稿

### 7. 发布设置
- **发布权限**: 支持公开发布或仅自己可见
- **发布状态**: 实时显示发布进度
- **发布成功**: 发布成功后自动跳转到文章列表

## 技术实现

### 组件架构
```
WriteArticle/
├── index.jsx              # 主组件
├── writeArticle.module.css # 样式文件
└── README.md              # 文档

Business/
├── ImageUploader/         # 图片上传组件
│   ├── index.jsx
│   └── imageUploader.module.css
├── LocationPicker/        # 位置选择组件
│   ├── index.jsx
│   └── locationPicker.module.css
└── index.js              # 组件导出
```

### 关键技术
- **React Hooks**: 使用useState、useCallback、useEffect等
- **本地存储**: 使用localStorage保存草稿和用户偏好
- **图片处理**: Canvas API实现图片压缩
- **地理定位**: Geolocation API获取当前位置
- **文件上传**: HTML5 File API处理文件选择
- **响应式设计**: CSS Grid和Flexbox实现自适应布局

### 性能优化
- **图片压缩**: 自动压缩大尺寸图片减少存储空间
- **懒加载**: 组件懒加载减少初始加载时间
- **防抖处理**: 搜索功能使用防抖减少API调用
- **内存管理**: 及时释放blob URL避免内存泄漏

## 使用指南

### 1. 创建新文章
1. 在文章列表页面点击写文章按钮
2. 进入写旅记页面开始编辑

### 2. 编辑内容
1. 输入文章标题（必填）
2. 选择适合的分类（衣/食/住/行）
3. 编写文章内容（必填）
4. 添加相关图片（可选）
5. 标记位置信息（可选）
6. 添加相关标签（可选）

### 3. 保存发布
1. 随时点击保存按钮保存草稿
2. 内容完成后点击发布按钮
3. 选择发布权限（公开/私密）
4. 确认发布，系统自动跳转

## 扩展功能

### 计划中的功能
- **语音输入**: 支持语音转文字输入
- **AI辅助**: AI智能写作建议和文本优化
- **模板库**: 提供不同类型的文章模板
- **协作编辑**: 支持多人协作编辑
- **版本历史**: 文章编辑历史记录
- **定时发布**: 支持定时发布功能

### API集成
- **图片上传API**: 集成云存储服务
- **地图服务API**: 集成高德/百度地图
- **AI服务API**: 集成智能写作助手
- **社交分享API**: 支持分享到各平台

## 注意事项

### 用户体验
- 保持操作简单直观
- 提供清晰的状态反馈
- 支持离线草稿保存
- 适配移动端操作习惯

### 数据安全
- 本地草稿加密存储
- 图片上传前预览确认
- 位置信息脱敏处理
- 用户数据隐私保护